#!/usr/bin/env bash

# shellcheck disable=SC1091
source "/toolbox64.env"  || exit 1
# shellcheck source=SCRIPTDIR/../../loader/bashlib64.bash disable=SC2154
source "${TOOLBOX64_LIB}/bashlib64.bash" || exit 1

#
# Main
#

declare source='postgresql:13'
declare packages='postgresql'
declare process='Install PostgreSQL 13 CLI'
declare -i status=0

bl64_os_match 'OL' &&
  bl64_check_privilege_root &&
  bl64_pkg_setup ||
  exit $?

bl64_msg_all_enable_verbose
bl64_msg_show_batch_start "$process"

bl64_msg_show_task "Enable package repository (${source})"
bl64_pkg_run_dnf --assumeyes module enable "$source" &&
  bl64_pkg_deploy $packages
status=$?

bl64_msg_show_batch_finish "$status" "$process"
exit $status
