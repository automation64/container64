#!/usr/bin/env bash

# shellcheck disable=SC1091
source "/toolbox64.env"  || exit $?
# shellcheck source=SCRIPTDIR/../../loader/bashlib64.bash disable=SC2154
source "${TOOLBOX64_LIB}/bashlib64.bash" || exit $?

#
# Main
#

declare repository_name='mongodb-org-5.0'
# shellcheck disable=SC2016
declare repository_url='https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/5.0/x86_64/'
declare repository_key='https://www.mongodb.org/static/pgp/server-5.0.asc'
declare packages='mongodb-org-tools mongodb-mongosh'
declare process='Install MongoDB Shell 5 CLI'
declare -i status=0

bl64_os_match "$BL64_OS_OL" &&
  bl64_check_privilege_root &&
  bl64_pkg_setup ||
  exit $?

bl64_msg_all_enable_verbose
bl64_msg_show_batch_start "$process"

bl64_pkg_repository_add "$repository_name" "$repository_url" "$repository_key"
# shellcheck disable=SC2086
bl64_pkg_deploy $packages
status=$?

bl64_msg_show_batch_finish "$status" "$process"
exit $status
